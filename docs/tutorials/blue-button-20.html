

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Blue Button 2.0 &mdash; Linux for Health  documentation</title>
  

  
  
  
  
    <link rel="canonical" href="https://linuxforhealth.github.io/docs/tutorials/blue-button-20.html"/>
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="FHIR R4" href="../routes/fhir-r4-rest.html" />
    <link rel="prev" title="HL7-v2" href="hl7-v2.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: 0x4380B4" >
          

          
            <a href="../index.html" class="icon icon-home"> Linux for Health
          

          
          </a>

          
            
            
              <div class="version">
                master
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer-setup.html">Developer Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="firstroute.html">Hello World</a></li>
<li class="toctree-l1"><a class="reference internal" href="../application-configuration.html">Application Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../feature-configuration.html">Feature Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../message-structure.html">Message Structure</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="fhir-r4.html">FHIR R4</a></li>
<li class="toctree-l1"><a class="reference internal" href="hl7-v2.html">HL7-v2</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Blue Button 2.0</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tutorial-steps">Tutorial Steps</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#authorize-linuxforhealth-to-use-the-blue-button-2-0-api">Authorize LinuxForHealth to use the Blue Button 2.0 API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configure-postman-for-blue-button-access">Configure Postman for Blue Button Access</a></li>
<li class="toctree-l3"><a class="reference internal" href="#send-a-blue-button-query-to-linuxforhealth">Send a Blue Button Query to LinuxForHealth</a></li>
<li class="toctree-l3"><a class="reference internal" href="#view-the-nats-notification-optional">View the NATS Notification (Optional)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#view-the-message-in-the-kafdrop-console-optional">View the Message in the Kafdrop Console (Optional)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Routes:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../routes/fhir-r4-rest.html">FHIR R4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../routes/orthanc-post.html">Orthanc DICOM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../routes/direct-storeandnotify.html">Direct Store and Notify</a></li>
</ul>
<p class="caption"><span class="caption-text">Develop:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../develop/extend.html">Developing for LinuxForHealth</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop/build.html">Building Your Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop/test.html">Testing Your Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop/property-encryption.html">Property Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop/route-basics.html">Developing Routes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop/configure-kong.html">Configuring Kong</a></li>
</ul>
<p class="caption"><span class="caption-text">Deployment:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../deployment/container.html">Container Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment/compose.html">Docker Compose Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment/openshift.html">OpenShift Container Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment/oci.html">Open Container Initiative (OCI)</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Linux for Health</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Blue Button 2.0</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorials/blue-button-20.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="blue-button-2-0">
<h1>Blue Button 2.0<a class="headerlink" href="#blue-button-2-0" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This tutorial provides instructions for using LinuxForHealth with <a class="reference external" href="https://bluebutton.cms.gov/developers/#blue-button-implementation-guide">Blue Button 2.0</a>, the CMS API that gives 53 million Medicare beneficiaries access to four years of Medicare Part A, B and D information.  The Blue Button 2.0 route in LinuxForHealth uses the Blue Button 2.0 Sandbox environment, which includes sample Medicare information for mock beneficiaries.  The route converts the results from FHIR R3 to R4, plus it includes standard steps of storage via a Kafka topic and notification via NATS.</p>
<p>Note: FHIR R3 to R4 conversion is performed for Patient and Coverage resources, but R3-&gt;R4 conversion is not yet possible for the ExplanationOfBenefit resource (not implemented in org.hl7.fhir.convertors).</p>
</div>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="../developer-setup.html">Developer Setup</a></p></li>
<li><p><a class="reference external" href="https://www.postman.com/downloads">Install Postman</a></p></li>
</ul>
</div>
<div class="section" id="tutorial-steps">
<h2>Tutorial Steps<a class="headerlink" href="#tutorial-steps" title="Permalink to this headline">¶</a></h2>
<p>Once you have completed the Prerequisites, follow these steps to use LinuxForHealth to work with Medicare FHIR resources.  You must be running LinuxForHealth locally (via ./gradlew run, as in the Developer Setup steps) to follow this tutorial, due to the default browser launch for Blue Button authorization.  Once you have a Blue Button access token, however, that token can be used with any LinuxForHealth instance.</p>
<div class="section" id="authorize-linuxforhealth-to-use-the-blue-button-2-0-api">
<h3>Authorize LinuxForHealth to use the Blue Button 2.0 API<a class="headerlink" href="#authorize-linuxforhealth-to-use-the-blue-button-2-0-api" title="Permalink to this headline">¶</a></h3>
<p>Open Postman and import this collection by clicking ‘Import’ -&gt; ‘Import File’ -&gt; ‘Choose Files’:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">connect</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">resources</span><span class="o">/</span><span class="n">messages</span><span class="o">/</span><span class="n">postman</span><span class="o">/</span><span class="n">LinuxForHealth</span> <span class="n">Examples</span><span class="o">.</span><span class="n">postman_collection</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>Click on the collection in the left navigation area and select ‘Authorize LinuxForHealth’, then click ‘Send’.</p>
<p>This operation opens your default browser and takes you to the Blue Button 2.0 Sandbox environment login.  Use these credentials to follow this tutorial, although there are 30K possible sample users to choose from:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Username: BBUser02153
Password: PW02153!
</pre></div>
</div>
<p>Select ‘Share all of your data’ and click ‘Allow’.  You can also elect to not share personal information, but this will give you a 403 Unauthorized result when you query for the Patient FHIR resources for this account.</p>
<p>From your browser window, copy the resulting ‘access_token’ and save it for the next step.</p>
</div>
<div class="section" id="configure-postman-for-blue-button-access">
<h3>Configure Postman for Blue Button Access<a class="headerlink" href="#configure-postman-for-blue-button-access" title="Permalink to this headline">¶</a></h3>
<p>In Postman, navigate to your LinuxForHealth Examples collection and click ‘…’ next to the collection name, then click ‘Edit’.</p>
<p>Click the ‘Authorization’ tab, then paste your new access_token from the previous section in the ‘Token’ field and click ‘Update’.</p>
<p>You are now ready to query for Medicare data using LinuxForHealth and the Blue Button 2.0 API.</p>
</div>
<div class="section" id="send-a-blue-button-query-to-linuxforhealth">
<h3>Send a Blue Button Query to LinuxForHealth<a class="headerlink" href="#send-a-blue-button-query-to-linuxforhealth" title="Permalink to this headline">¶</a></h3>
<p>From the Examples collection in Postman, select ‘BlueB - Get patient details’ and click ‘Send’.</p>
<p>You should see a result similar to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
 <span class="s2">&quot;meta&quot;</span><span class="p">:</span> <span class="p">{</span>
     <span class="s2">&quot;routeId&quot;</span><span class="p">:</span> <span class="s2">&quot;bluebutton-20&quot;</span><span class="p">,</span>
     <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;6735c7ef-3640-434e-9563-2ed38958b21a&quot;</span><span class="p">,</span>
     <span class="s2">&quot;routeUrl&quot;</span><span class="p">:</span> <span class="s2">&quot;http://0.0.0.0:8080/bluebutton/v1/Patient?-19990000002154&quot;</span><span class="p">,</span>
     <span class="s2">&quot;dataFormat&quot;</span><span class="p">:</span> <span class="s2">&quot;FHIR-R4&quot;</span><span class="p">,</span>
     <span class="s2">&quot;messageType&quot;</span><span class="p">:</span> <span class="s2">&quot;PATIENT&quot;</span><span class="p">,</span>
     <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="mi">1594050020</span><span class="p">,</span>
     <span class="s2">&quot;dataStoreUri&quot;</span><span class="p">:</span> <span class="s2">&quot;kafka:FHIR-R4_PATIENT?brokers=localhost:9092&quot;</span><span class="p">,</span>
     <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
     <span class="s2">&quot;dataRecordLocation&quot;</span><span class="p">:</span> <span class="p">[</span>
         <span class="s2">&quot;FHIR-R4_PATIENT-0@21&quot;</span>
     <span class="p">]</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The result indicates the topic, partition and offset of the message in Kafka.  ‘Get EOB details’ and ‘Get coverage details’ queries from the Postman collection provide similar results for ExplanationofBenefit and Coverage resources.</p>
</div>
<div class="section" id="view-the-nats-notification-optional">
<h3>View the NATS Notification (Optional)<a class="headerlink" href="#view-the-nats-notification-optional" title="Permalink to this headline">¶</a></h3>
<p>You should also see a NATS notification in the LinuxForHealth connect log.  If you are running the LinuxForHealth connect application locally, you should see a message in the connect console window similar to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">15</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span><span class="mf">29.474</span> <span class="p">[</span><span class="n">nats</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="n">INFO</span>  <span class="n">c</span><span class="o">.</span><span class="n">l</span><span class="o">.</span><span class="n">connect</span><span class="o">.</span><span class="n">support</span><span class="o">.</span><span class="n">NATSSubscriber</span> <span class="o">-</span> <span class="n">nats</span><span class="o">-</span><span class="n">subscriber</span><span class="o">-</span><span class="n">localhost</span><span class="p">:</span><span class="mi">4222</span><span class="o">-</span><span class="n">lfh</span><span class="o">-</span><span class="n">events</span> <span class="n">received</span> <span class="n">message</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;meta&quot;</span><span class="p">:{</span><span class="s2">&quot;routeId&quot;</span><span class="p">:</span><span class="s2">&quot;fhir-r4-rest&quot;</span><span class="p">,</span><span class="s2">&quot;uuid&quot;</span><span class="p">:</span><span class="s2">&quot;8bebaaae-a30b-4d8e-8424-d38836bf1d14&quot;</span><span class="p">,</span><span class="s2">&quot;routeUri&quot;</span><span class="p">:</span><span class="s2">&quot;jetty:http://0.0.0.0:8080/fhir/r4/Patient?httpMethodRestrict=POST&quot;</span><span class="p">,</span><span class="s2">&quot;dataFormat&quot;</span><span class="p">:</span><span class="s2">&quot;FHIR-R4&quot;</span><span class="p">,</span><span class="s2">&quot;messageType&quot;</span><span class="p">:</span><span class="s2">&quot;PATIENT&quot;</span><span class="p">,</span><span class="s2">&quot;timestamp&quot;</span><span class="p">:</span><span class="mi">1597868068</span><span class="p">,</span><span class="s2">&quot;dataStoreUri&quot;</span><span class="p">:</span><span class="s2">&quot;kafka:FHIR-R4_PATIENT?brokers=localhost:9092&quot;</span><span class="p">,</span><span class="s2">&quot;status&quot;</span><span class="p">:</span><span class="s2">&quot;success&quot;</span><span class="p">,</span><span class="s2">&quot;dataRecordLocation&quot;</span><span class="p">:[</span><span class="s2">&quot;FHIR-R4_PATIENT-0@21&quot;</span><span class="p">]}}</span>
</pre></div>
</div>
<p>If you are running a LinuxForHealth container within docker-compose, in a console window, navigate to the connect compose directory and view the logs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">connect</span><span class="o">/</span><span class="n">container</span><span class="o">-</span><span class="n">support</span><span class="o">/</span><span class="n">compose</span>
<span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="n">logs</span> <span class="o">-</span><span class="n">f</span> <span class="n">lfh</span>
</pre></div>
</div>
<p>The message received by the NATS subscriber also indicates the topic, partition and offset of the message in Kafka, which could be used for downstream application integration.</p>
</div>
<div class="section" id="view-the-message-in-the-kafdrop-console-optional">
<h3>View the Message in the Kafdrop Console (Optional)<a class="headerlink" href="#view-the-message-in-the-kafdrop-console-optional" title="Permalink to this headline">¶</a></h3>
<p>You can optionally view the message contents in Kafka, via the Kafdrop Kafka client.  In your browser, navigate to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">9000</span><span class="o">/</span>
</pre></div>
</div>
<p>Scroll down and click on the ‘FHIR-R4_PATIENT’ topic.</p>
<p>Click ‘View Messages’, then click ‘View Messages’ again on the next page.  This will take you to a list of all messages for the topic.</p>
<p>Navigate to the message at the offset indicated in the query results.  For example, from <a class="reference external" href="mailto:'FHIR-R4_PATIENT-0&#37;&#52;&#48;21">‘FHIR-R4_PATIENT-0<span>&#64;</span>21</a>’ in the result, we know the message is at offset ‘21’ in the ‘FHIR-R4_PATIENT’ topic.  At your result offset, you should see the bundle of Blue Button FHIR patient resources you just requested from LinuxForHealth.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../routes/fhir-r4-rest.html" class="btn btn-neutral float-right" title="FHIR R4" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="hl7-v2.html" class="btn btn-neutral float-left" title="HL7-v2" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, IBM

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
 
<div class="footer">
    <p>
        LinuxForHealth is sublicensed by the Linux Foundation with Sublicense ID: 20200615-0008
    </p>
</div>    


</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>