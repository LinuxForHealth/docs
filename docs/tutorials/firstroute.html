

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Build Your First Route &mdash; Linux for Health  documentation</title>
  

  
  
  
  
    <link rel="canonical" href="https://linuxforhealth.github.io/docs/tutorials/firstroute.html"/>
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="FHIR R4" href="fhir-r4.html" />
    <link rel="prev" title="Send Your First Message" href="quickstart.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: 0x4380B4" >
          

          
            <a href="../index.html" class="icon icon-home"> Linux for Health
          

          
          </a>

          
            
            
              <div class="version">
                master
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer-setup.html">Developer Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../application-configuration.html">Application Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../message-structure.html">Message Structure</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Send Your First Message</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Build Your First Route</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="#steps">Steps</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hello-world-route">Hello World Route</a></li>
<li class="toctree-l3"><a class="reference internal" href="#modify-the-route-and-rebuild">Modify the Route and Rebuild</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fhir-r4.html">FHIR R4</a></li>
<li class="toctree-l1"><a class="reference internal" href="hl7-v2.html">HL7-v2</a></li>
<li class="toctree-l1"><a class="reference internal" href="blue-button-20.html">Blue Button 2.0</a></li>
</ul>
<p class="caption"><span class="caption-text">Routes:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../routes/fhir-r4-rest.html">FHIR R4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../routes/orthanc-post.html">Orthanc DICOM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../routes/direct-storeandnotify.html">Direct Store and Notify</a></li>
</ul>
<p class="caption"><span class="caption-text">Develop:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../develop/extend.html">Developing for Linux for Health</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop/build.html">Building Your Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop/test.html">Testing Your Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop/property-encryption.html">Property Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop/route-basics.html">Developing Routes</a></li>
</ul>
<p class="caption"><span class="caption-text">Deployment:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../deployment/container.html">Container Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment/compose.html">Docker Compose Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment/openshift.html">OpenShift Container Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment/oci.html">Open Container Initiative (OCI)</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Linux for Health</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Build Your First Route</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorials/firstroute.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="build-your-first-route">
<h1>Build Your First Route<a class="headerlink" href="#build-your-first-route" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This tutorial shows you how to build your first route starting with the Linux for Health “Hello World” route.</p>
</div>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="../developer-setup.html">Developer Setup</a></p></li>
</ul>
</div>
<div class="section" id="steps">
<h2>Steps<a class="headerlink" href="#steps" title="Permalink to this headline">¶</a></h2>
<p>Once you have completed the Prerequisites, follow these steps to build your first Linux for Health route.</p>
<div class="section" id="hello-world-route">
<h3>Hello World Route<a class="headerlink" href="#hello-world-route" title="Permalink to this headline">¶</a></h3>
<p>Linux for Health provides a “Hello World” route in <code class="docutils literal notranslate"><span class="pre">connect/src/main/java/com/linuxforhealth/connect/builder/ExampleRouteBuilder.java</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/**</span>
  <span class="o">*</span> <span class="s2">&quot;Hello World&quot;</span> <span class="n">example</span> <span class="n">route</span><span class="o">.</span>
  <span class="o">*/</span>
 <span class="n">from</span><span class="p">(</span><span class="s2">&quot;{{lfh.connect.example.uri}}&quot;</span><span class="p">)</span>
     <span class="o">.</span><span class="n">routeId</span><span class="p">(</span><span class="n">HELLO_WORLD_ROUTE_ID</span><span class="p">)</span>
     <span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">exchange</span> <span class="o">-&gt;</span> <span class="p">{</span>
         <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">simple</span><span class="p">(</span><span class="s2">&quot;$</span><span class="si">{headers.name}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">exchange</span><span class="p">,</span> <span class="n">String</span><span class="o">.</span><span class="n">class</span><span class="p">);</span>
         <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;Hello World! It&#39;s &quot;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s2">&quot;.&quot;</span><span class="p">;</span>
         <span class="o">//</span> <span class="n">Add</span> <span class="n">your</span> <span class="n">code</span> <span class="n">here</span>
         <span class="n">exchange</span><span class="o">.</span><span class="n">getIn</span><span class="p">()</span><span class="o">.</span><span class="n">setBody</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
     <span class="p">})</span>
     <span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">new</span> <span class="n">MetaDataProcessor</span><span class="p">(</span><span class="n">routePropertyNamespace</span><span class="p">))</span>
     <span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">LinuxForHealthRouteBuilder</span><span class="o">.</span><span class="n">STORE_AND_NOTIFY_CONSUMER_URI</span><span class="p">)</span>
     <span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">HELLO_WORLD_PRODUCER_ID</span><span class="p">);</span>
</pre></div>
</div>
<p>You can run this route using the curl command.  From a console window, copy and paste the following command.  You can change the value of name being passed in as a query param from <code class="docutils literal notranslate"><span class="pre">me</span></code> to anything, then hit <code class="docutils literal notranslate"><span class="pre">return</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>curl http://localhost:9090/hello-world?name=me
</pre></div>
</div>
<p>This sends an HTTP GET request to Linux for Health, which is processed by the route code above.  The <code class="docutils literal notranslate"><span class="pre">.process</span></code> step gets the value of the query param <code class="docutils literal notranslate"><span class="pre">name</span></code>, which was passed in as an exchange message header by Camel, then forms the response and sets the exchange message body to the result.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">.process(new</span> <span class="pre">MetaDataProcessor(routePropertyNamespace))</span></code> and <code class="docutils literal notranslate"><span class="pre">.to(LinuxForHealthRouteBuilder.STORE_AND_NOTIFY_CONSUMER_URI)</span></code> are built-in Linux for Health steps that form the message to be stored in Kafka based on your data, then send that message to Kafka and then to NATS subscribers for further use.</p>
<p>You should see the following result (all in one line):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="s2">&quot;meta&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;routeId&quot;</span><span class="p">:</span> <span class="s2">&quot;hello-world&quot;</span><span class="p">,</span>
      <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;71257051-f2e0-495b-b0d9-beb785b3f850&quot;</span><span class="p">,</span>
      <span class="s2">&quot;routeUri&quot;</span><span class="p">:</span> <span class="s2">&quot;jetty:http://0.0.0.0:9090/hello-world?httpMethodRestrict=GET&quot;</span><span class="p">,</span>
      <span class="s2">&quot;dataFormat&quot;</span><span class="p">:</span> <span class="s2">&quot;EXAMPLE&quot;</span><span class="p">,</span>
      <span class="s2">&quot;messageType&quot;</span><span class="p">:</span> <span class="s2">&quot;TEXT&quot;</span><span class="p">,</span>
      <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="mi">1599076120</span><span class="p">,</span>
      <span class="s2">&quot;dataStoreUri&quot;</span><span class="p">:</span> <span class="s2">&quot;kafka:EXAMPLE_TEXT?brokers=localhost:9094&quot;</span><span class="p">,</span>
      <span class="s2">&quot;dataRecordLocation&quot;</span><span class="p">:[</span><span class="s2">&quot;EXAMPLE_TEXT-0@0&quot;</span><span class="p">]</span>
   <span class="p">},</span>
   <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;SGVsbG8gV29ybGQhIEl0J3MgbWUu&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The data value is base64-encoded.  Decode this with any base64 decoder (several web sites do this) and you get the string “Hello World! It’s me.”  To recap, you sent an HTTP GET to Linux for Health, which stored the result in a topic called EXAMPLE_TEXT.</p>
</div>
<div class="section" id="modify-the-route-and-rebuild">
<h3>Modify the Route and Rebuild<a class="headerlink" href="#modify-the-route-and-rebuild" title="Permalink to this headline">¶</a></h3>
<p>In this step, you will modify the “Hello World” route, rebuild it and run it.  First, open <code class="docutils literal notranslate"><span class="pre">connect/src/main/java/com/linuxforhealth/connect/builder/ExampleRouteBuilder.java</span></code> in an editor.  Change the line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;Hello World! It&#39;s &quot;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s2">&quot;.&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p>to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;It&#39;s always sunny in &quot;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s2">&quot;.&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p>Save the file and in the console window where you started Linux for Health connect via <code class="docutils literal notranslate"><span class="pre">./gradlew</span> <span class="pre">run</span></code>, type ctrl-C to stop it.  Rebuild Linux for Health by typing <code class="docutils literal notranslate"><span class="pre">./gradlew</span> <span class="pre">clean</span> <span class="pre">build</span></code> and then <code class="docutils literal notranslate"><span class="pre">./gradlew</span> <span class="pre">run</span></code>.  The run the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>curl http://localhost:9090/hello-world?name=Austin
</pre></div>
</div>
<p>You should see the following result (all in one line):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="s2">&quot;meta&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;routeId&quot;</span><span class="p">:</span> <span class="s2">&quot;hello-world&quot;</span><span class="p">,</span>
      <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;71257051-f2e0-495b-b0d9-beb785b3f850&quot;</span><span class="p">,</span>
      <span class="s2">&quot;routeUri&quot;</span><span class="p">:</span> <span class="s2">&quot;jetty:http://0.0.0.0:9090/hello-world?httpMethodRestrict=GET&quot;</span><span class="p">,</span>
      <span class="s2">&quot;dataFormat&quot;</span><span class="p">:</span> <span class="s2">&quot;EXAMPLE&quot;</span><span class="p">,</span>
      <span class="s2">&quot;messageType&quot;</span><span class="p">:</span> <span class="s2">&quot;TEXT&quot;</span><span class="p">,</span>
      <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="mi">1599076120</span><span class="p">,</span>
      <span class="s2">&quot;dataStoreUri&quot;</span><span class="p">:</span> <span class="s2">&quot;kafka:EXAMPLE_TEXT?brokers=localhost:9094&quot;</span><span class="p">,</span>
      <span class="s2">&quot;dataRecordLocation&quot;</span><span class="p">:[</span><span class="s2">&quot;EXAMPLE_TEXT-0@0&quot;</span><span class="p">]</span>
   <span class="p">},</span>
   <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;SXQncyBhbHdheXMgc3VubnkgaW4gQXVzdGluCg==&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Decode the data field with any base64 decoder and you get the string “It’s always sunny in Austin”.</p>
<p>So far, you’ve run a route, modified it, rebuilt it and run it again to see your changes.  As a next step, you can copy the whole <code class="docutils literal notranslate"><span class="pre">connect/src/main/java/com/linuxforhealth/connect/builder/ExampleRouteBuilder.java</span></code> file, rename it in the same directory and use it as a basis for a brand new route, taking care to create any new environment variables in <code class="docutils literal notranslate"><span class="pre">src/main/resources/application.properties</span></code> when needed.</p>
<p>Also, as you work more with routes, consider installing <a class="reference external" href="http://postman.com">Postman</a> and importing the Linux for Health Postman collection <cite>connect/src/test/resources/messages/postman/Linux for Health Examples.postman_collection.json</cite> to make HTTP and REST calls.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="fhir-r4.html" class="btn btn-neutral float-right" title="FHIR R4" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="quickstart.html" class="btn btn-neutral float-left" title="Send Your First Message" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, IBM

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>