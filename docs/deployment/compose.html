

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Docker Compose Support &mdash; Linux for Health  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />

  
  

  
  
    <link rel="canonical" href="https://linuxforhealth.github.io/docs/deployment/compose.html"/>
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Container Support" href="container.html" />
    <link rel="prev" title="Data Synchronization" href="../develop/data-synchronization.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: 0x4380B4" >
          

          
            <a href="../index.html" class="icon icon-home"> Linux for Health
          

          
          </a>

          
            
            
              <div class="version">
                master
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer-setup.html">Developer Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/quickstart.html">QuickStart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../application-configuration.html">Application Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../message-structure.html">Message Structure</a></li>
</ul>
<p class="caption"><span class="caption-text">Routes:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../routes/fhir-r4.html">FHIR R4</a></li>
</ul>
<p class="caption"><span class="caption-text">Develop:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../develop/develop.html">LinuxForHealth Connect Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop/secured-communications.html">Secured Communications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop/data-synchronization.html">Data Synchronization</a></li>
</ul>
<p class="caption"><span class="caption-text">Deployment:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Docker Compose Support</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#starting-the-lfh-compose-stack">Starting the LFH Compose Stack</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="container.html">Container Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="kubernetes.html">Kubernetes Support</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Linux for Health</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Docker Compose Support</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/deployment/compose.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="docker-compose-support">
<h1>Docker Compose Support<a class="headerlink" href="#docker-compose-support" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>LinuxForHealth (LFH) connect provides an out-of-the-box Docker Compose configuration with support for <a class="reference external" href="https://docs.docker.com/compose/profiles/">profiles</a> that enable deploying specific support services in addition to connect. We will go through the supported profiles and usage below.</p>
</div>
<div class="section" id="starting-the-lfh-compose-stack">
<h2>Starting the LFH Compose Stack<a class="headerlink" href="#starting-the-lfh-compose-stack" title="Permalink to this headline">¶</a></h2>
<p>The syntax to launch the LFH compose stack is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="o">--</span><span class="n">profile</span> <span class="p">[</span><span class="n">profile</span> <span class="n">name</span><span class="p">]</span> <span class="n">up</span> <span class="o">-</span><span class="n">d</span>
<span class="c1"># Multiple profiles can be specified in this fashion:</span>
<span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="o">--</span><span class="n">profile</span> <span class="p">[</span><span class="n">profile</span> <span class="n">name</span><span class="p">]</span> <span class="o">--</span><span class="n">profile</span> <span class="p">[</span><span class="n">profile</span><span class="o">-</span><span class="n">name</span><span class="p">]</span> <span class="n">up</span> <span class="o">-</span><span class="n">d</span>
</pre></div>
</div>
<p>Where [profile name] is the name of a supported LFH profile.</p>
<p>Supported profiles include:</p>
<ul class="simple">
<li><p>deployment</p></li>
<li><p>ipfs</p></li>
<li><p>fhir</p></li>
</ul>
<p>Additional profiles will be added as needed to support external systems for new LFH integration use-cases.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 86%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Profile Name</p></th>
<th class="head"><p>Profile Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>deployment</p></td>
<td><p>For bundled deployment of <code class="docutils literal notranslate"><span class="pre">connect</span></code> along with the support services with ports mapped to localhost.</p></td>
</tr>
<tr class="row-odd"><td><p>ipfs</p></td>
<td><p>Deploys IPFS nodes and an IPFS cluster for managing pinsets.</p></td>
</tr>
<tr class="row-even"><td><p>fhir</p></td>
<td><p>Deploys the IBM Fhir Server.</p></td>
</tr>
</tbody>
</table>
<p><strong>NOTE::</strong> All <code class="docutils literal notranslate"><span class="pre">docker-compose</span></code> commands always deploy support services Kafka, Zookeeper &amp; NATS by default.</p>
<p>Not specifying a profile name would lead to deploying Kafka, Zookeeper &amp; NATS which are the default support services for connect:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># navigate to the ``connect`` project directory</span>
<span class="n">cd</span> <span class="o">./</span><span class="n">connect</span>
<span class="c1"># run the docker-compose command with no profile specified</span>
<span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="n">up</span> <span class="o">-</span><span class="n">d</span>
<span class="c1"># Kafka, Zookeeper &amp; NATS should be deployed</span>
</pre></div>
</div>
<p>Deploying only the support services can come in handy in use-cases where connect is run external of the compose stack.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">deployment</span></code> profile supports spinning up connect application along with default support services:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># navigate to the ``connect`` project directory</span>
<span class="n">cd</span> <span class="o">./</span><span class="n">connect</span>
<span class="c1"># run the docker-compose command with ``deployment`` profile specified</span>
<span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="o">--</span><span class="n">profile</span> <span class="n">deployment</span> <span class="n">up</span> <span class="o">-</span><span class="n">d</span>
<span class="c1"># connect, Kafka, Zookeeper &amp; NATS should now be deployed</span>
</pre></div>
</div>
<p>Using the <code class="docutils literal notranslate"><span class="pre">deployment</span></code> profile would be the out-of-the-box solution for most users of the compose stack</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ipfs</span></code> profile deploys a 3 node IPFS peer and IPFS cluster in addition to the default support services. Using the <code class="docutils literal notranslate"><span class="pre">deployment</span></code> profile in addition to <code class="docutils literal notranslate"><span class="pre">ipfs</span></code> profile would ensure that connect, Kafka, Zookeeper, NATS and IPFS are deployed simultaneously. Note, the modular nature of docker-compose profiles would allow users to only deploy <code class="docutils literal notranslate"><span class="pre">ipfs</span></code> as an additional support service to an already <code class="docutils literal notranslate"><span class="pre">deployment</span></code> profile stack that is up and running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># navigate to the ``connect`` project directory</span>
<span class="n">cd</span> <span class="o">./</span><span class="n">connect</span>
<span class="c1"># run the docker-compose command with ``deployment`` and ``ipfs`` profile specified</span>
<span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="o">--</span><span class="n">profile</span> <span class="n">deployment</span> <span class="o">--</span><span class="n">profile</span> <span class="n">ipfs</span> <span class="n">up</span> <span class="o">-</span><span class="n">d</span>
<span class="c1"># connect, Kafka, Zookeeper, NATS &amp; IPFS should now be deployed</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">fhir</span></code> profile allows deploying the <a class="reference external" href="https://ibm.github.io/FHIR/">IBM FHIR Server</a> in addition to other support services:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># navigate to the ``connect`` project directory</span>
<span class="n">cd</span> <span class="o">./</span><span class="n">connect</span>
<span class="c1"># run the docker-compose command with ``fhir`` profile specified</span>
<span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="o">--</span><span class="n">profile</span> <span class="n">fhir</span> <span class="n">up</span> <span class="o">-</span><span class="n">d</span>
<span class="c1"># chain together deployment &amp; fhir profiles</span>
<span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="o">---</span><span class="n">profile</span> <span class="n">deployment</span> <span class="o">--</span><span class="n">profile</span> <span class="n">fhir</span> <span class="n">up</span> <span class="o">-</span><span class="n">d</span>
</pre></div>
</div>
<p>Use standard docker-compose commands to interact with the stack and it’s services. Stop containers leaving them intact for starting them back up again or tear down down deployments using profiles similarly as for when deploying them initially, as shown in the examples above:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># stops all containers leaving them intact</span>
<span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="n">stop</span> <span class="c1"># containers may be removed with docker-compose down -v</span>
<span class="c1"># tear down deployment of connect, Kafka, Zookeeper &amp; NATS</span>
<span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="o">--</span><span class="n">profile</span> <span class="n">deployment</span> <span class="n">down</span>
<span class="c1"># tear down ipfs &amp; fhir server (together or separately)</span>
<span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="o">--</span><span class="n">profile</span> <span class="n">ipfs</span> <span class="o">--</span><span class="n">profile</span> <span class="n">fhir</span> <span class="n">down</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="container.html" class="btn btn-neutral float-right" title="Container Support" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../develop/data-synchronization.html" class="btn btn-neutral float-left" title="Data Synchronization" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright .

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
 
<div class="footer">
    <p>
        LinuxForHealth is sublicensed by the Linux Foundation with Sublicense ID: 20200615-0008
    </p>
</div>    


</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>