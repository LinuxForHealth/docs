

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Application Configuration &mdash; Linux for Health  documentation</title>
  

  
  
  
  
    <link rel="canonical" href="https://linuxforhealth.github.io/docs/application-configuration.html"/>
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Message Structure" href="message-structure.html" />
    <link rel="prev" title="Hello World" href="tutorials/firstroute.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: 0x4380B4" >
          

          
            <a href="index.html" class="icon icon-home"> Linux for Health
          

          
          </a>

          
            
            
              <div class="version">
                master
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="developer-setup.html">Developer Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/firstroute.html">Hello World</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Application Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#properties-based-configuration">Properties based configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#linux-for-health-bean-properties">Linux for Health Bean Properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="#linux-for-health-route-properties">Linux for Health Route Properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="#property-evaluation">Property Evaluation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="message-structure.html">Message Structure</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials/quickstart.html">Send Your First Message</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/fhir-r4.html">FHIR R4</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/hl7-v2.html">HL7-v2</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/blue-button-20.html">Blue Button 2.0</a></li>
</ul>
<p class="caption"><span class="caption-text">Routes:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="routes/fhir-r4-rest.html">FHIR R4</a></li>
<li class="toctree-l1"><a class="reference internal" href="routes/orthanc-post.html">Orthanc DICOM</a></li>
<li class="toctree-l1"><a class="reference internal" href="routes/direct-storeandnotify.html">Direct Store and Notify</a></li>
</ul>
<p class="caption"><span class="caption-text">Develop:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="develop/extend.html">Developing for Linux for Health</a></li>
<li class="toctree-l1"><a class="reference internal" href="develop/build.html">Building Your Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="develop/test.html">Testing Your Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="develop/property-encryption.html">Property Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="develop/route-basics.html">Developing Routes</a></li>
</ul>
<p class="caption"><span class="caption-text">Deployment:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="deployment/container.html">Container Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="deployment/compose.html">Docker Compose Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="deployment/openshift.html">OpenShift Container Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="deployment/oci.html">Open Container Initiative (OCI)</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Linux for Health</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Application Configuration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/application-configuration.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="application-configuration">
<h1>Application Configuration<a class="headerlink" href="#application-configuration" title="Permalink to this headline">¶</a></h1>
<div class="section" id="properties-based-configuration">
<h2>Properties based configuration<a class="headerlink" href="#properties-based-configuration" title="Permalink to this headline">¶</a></h2>
<p>Linux for Health application settings are configured in an application.properties file stored within the project under <em>src/main/resources</em>.
Linux for Health properties reside within the following namespaces:</p>
<ul class="simple">
<li><p>lfh.connect.bean</p></li>
<li><p>lfh.connect.[route id]</p></li>
</ul>
<p>The bean namespace specifies Java beans used to enrich route processing.
The route namespace contains properties used to drive and configure a data processing route.
Within the route namespace, the following properties are required:</p>
<ul class="simple">
<li><p>lfh.connect.[route id].uri</p></li>
<li><p>lfh.connect.[route id].dataformat</p></li>
<li><p>lfh.connect.[route id].messagetype</p></li>
</ul>
</div>
<div class="section" id="linux-for-health-bean-properties">
<h2>Linux for Health Bean Properties<a class="headerlink" href="#linux-for-health-bean-properties" title="Permalink to this headline">¶</a></h2>
<p>Bean properties format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lfh</span><span class="o">.</span><span class="n">connect</span><span class="o">.</span><span class="n">bean</span><span class="o">.</span><span class="p">[</span><span class="n">bean</span> <span class="n">name</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">bean</span> <span class="n">class</span><span class="p">]</span>
</pre></div>
</div>
<p>The <strong>[bean name]</strong> is the lookup key used to search for the bean within the Camel Registry.
The <strong>[bean class]</strong> is the fully qualified class name for the bean, which is used to instantiate the bean/POJO and add it
to the Camel Registry.</p>
<p>A bean, or “Java Bean”, is simply a Java class which adheres to the following principles:
- Has a default, no-argument constructor.
- Utilizes accessors, getters and setters, to access and set properties.
- Implements the Serializable interface.</p>
<p>In contrast, a POJO, or Plain Old Java Object, is a Java class which does not adhere to a specific convention.</p>
<p>Linux for Health utilizes the “bean” term as this is the term used in the underlying Camel framework when binding objects to a registry.</p>
<p>Beans are used within Linux for Health to assist with route and message processing. For example, the following properties define HL7 decoder
and encoder beans used to in HL7 messaging processing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lfh</span><span class="o">.</span><span class="n">connect</span><span class="o">.</span><span class="n">bean</span><span class="o">.</span><span class="n">hl7decoder</span><span class="o">=</span><span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">camel</span><span class="o">.</span><span class="n">component</span><span class="o">.</span><span class="n">hl7</span><span class="o">.</span><span class="n">HL7MLLPNettyDecoderFactory</span>
<span class="n">lfh</span><span class="o">.</span><span class="n">connect</span><span class="o">.</span><span class="n">bean</span><span class="o">.</span><span class="n">hl7encoder</span><span class="o">=</span><span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">camel</span><span class="o">.</span><span class="n">component</span><span class="o">.</span><span class="n">hl7</span><span class="o">.</span><span class="n">HL7MLLPNettyEncoderFactory</span>
</pre></div>
</div>
</div>
<div class="section" id="linux-for-health-route-properties">
<h2>Linux for Health Route Properties<a class="headerlink" href="#linux-for-health-route-properties" title="Permalink to this headline">¶</a></h2>
<p>Route properties format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lfh</span><span class="o">.</span><span class="n">connect</span><span class="o">.</span><span class="p">[</span><span class="n">route</span> <span class="nb">id</span><span class="p">]</span><span class="o">.</span><span class="p">[</span><span class="nb">property</span><span class="p">]</span>
</pre></div>
</div>
<p>Where <strong>[route id]</strong> is the route id defined in the Java DSL and <strong>[property]</strong> is the setting’s property key.
LFH property keys consist of lower-case characters separated by “.” to provide namespacing.
A namespace may contain a “-” if needed.</p>
<p>The following route properties are <strong>required</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 41%" />
<col style="width: 59%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>lfh.connect.[route id].uri</p></td>
<td><p>The consumer URI for the route</p></td>
</tr>
<tr class="row-odd"><td><p>lfh.connect.[route id].dataformat</p></td>
<td><p>The data format (HL7, FHIR, etc) used in the route</p></td>
</tr>
<tr class="row-even"><td><p>lfh.connect.[route id].messagetype</p></td>
<td><p>The type of message within the format</p></td>
</tr>
</tbody>
</table>
<p>The <strong>uri</strong> property supports <a class="reference external" href="https://camel.apache.org/manual/latest/using-propertyplaceholder.html#UsingPropertyPlaceholder-ExamplesUsingPropertiesComponent">Camel’s Property Placeholder Component</a> which allows developers to use <a class="reference external" href="https://camel.apache.org/components/latest/languages/simple-language.html">Simple Expressions</a> within the route’s <a class="reference external" href="https://camel.apache.org/manual/latest/java-dsl.html">Java DSL</a> .</p>
<p>In the HL7v2 MLLP example below, properties are defined for the route’s consumer host and uri. Note that the <strong>uri</strong> property employs the simple expression templating tags to reuse the host property.</p>
<p>HL7v2 MLLP Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>lfh.connect.hl7-v2.host=0.0.0.0:2575
lfh.connect.hl7-v2.uri=netty:tcp://{{lfh.connect.hl7-v2.host}}?sync=true&amp;encoders=#hl7encoder&amp;decoders=#hl7decoder
</pre></div>
</div>
<p>Within the HL7v2 MLLP route, the simple templating tags are used to reference the <strong>uri</strong> property:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Override</span>
<span class="n">public</span> <span class="n">void</span> <span class="n">buildRoute</span><span class="p">(</span><span class="n">routePropertyNamespace</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">from</span><span class="p">(</span><span class="s2">&quot;{{lfh.connect.hl7-v2.uri}}&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">routeId</span><span class="p">(</span><span class="n">HL7_V2_MLLP_ROUTE_ID</span><span class="p">)</span>
            <span class="o">.</span><span class="n">unmarshal</span><span class="p">()</span><span class="o">.</span><span class="n">hl7</span><span class="p">()</span>
            <span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">new</span> <span class="n">MetaDataProcessor</span><span class="p">(</span><span class="n">routePropertyNamespace</span><span class="p">))</span>
            <span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">LinuxForHealthRouteBuilder</span><span class="o">.</span><span class="n">STORE_AND_NOTIFY_CONSUMER_URI</span><span class="p">)</span>
            <span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">ROUTE_PRODUCER_ID</span><span class="p">);;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Routes which utilize the REST DSL, such as the FHIR R4 REST route, parse properties using a convenience function in <a class="reference external" href="https://github.com/LinuxForHealth/connect/blob/master/src/main/java/com/linuxforhealth/connect/support/CamelContextSupport.java">CamelContextSupport</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@Override</span>
<span class="n">public</span> <span class="n">void</span> <span class="n">buildRoute</span><span class="p">(</span><span class="n">String</span> <span class="n">routePropertyNamespace</span><span class="p">)</span> <span class="p">{</span>

    <span class="n">CamelContextSupport</span> <span class="n">contextSupport</span> <span class="o">=</span> <span class="n">new</span> <span class="n">CamelContextSupport</span><span class="p">(</span><span class="n">getContext</span><span class="p">());</span>
    <span class="n">URI</span> <span class="n">fhirBaseUri</span> <span class="o">=</span> <span class="n">URI</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">contextSupport</span><span class="o">.</span><span class="n">getProperty</span><span class="p">(</span><span class="s2">&quot;lfh.connect.fhir-r4.uri&quot;</span><span class="p">));</span>

    <span class="n">restConfiguration</span><span class="p">()</span>
            <span class="o">.</span><span class="n">host</span><span class="p">(</span><span class="n">fhirBaseUri</span><span class="o">.</span><span class="n">getHost</span><span class="p">())</span>
            <span class="o">.</span><span class="n">port</span><span class="p">(</span><span class="n">fhirBaseUri</span><span class="o">.</span><span class="n">getPort</span><span class="p">());</span>

    <span class="n">rest</span><span class="p">(</span><span class="n">fhirBaseUri</span><span class="o">.</span><span class="n">getPath</span><span class="p">())</span>
            <span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;/</span><span class="si">{resource}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">route</span><span class="p">()</span>
            <span class="o">.</span><span class="n">routeId</span><span class="p">(</span><span class="n">FHIR_R4_ROUTE_ID</span><span class="p">)</span>
            <span class="o">.</span><span class="n">unmarshal</span><span class="p">()</span><span class="o">.</span><span class="n">fhirJson</span><span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">marshal</span><span class="p">()</span><span class="o">.</span><span class="n">fhirJson</span><span class="p">(</span><span class="s2">&quot;R4&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">new</span> <span class="n">MetaDataProcessor</span><span class="p">(</span><span class="n">routePropertyNamespace</span><span class="p">))</span>
            <span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">LinuxForHealthRouteBuilder</span><span class="o">.</span><span class="n">STORE_AND_NOTIFY_CONSUMER_URI</span><span class="p">)</span>
            <span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">ROUTE_PRODUCER_ID</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The route’s <strong>messagetype</strong> property supports simple expressions, which may be used to dynamically assign a value during route processing. In the  example below, the HL7 route’s parses its <strong>messageFormat</strong> from the Camel message header:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>lfh.connect.hl7-v2.messagetype=\${header.CamelHL7MessageType}
</pre></div>
</div>
<p>The “$” is escaped using a “&quot; to ensure that the expression is not evaluated using Groovy’s templating syntax.</p>
</div>
<div class="section" id="property-evaluation">
<h2>Property Evaluation<a class="headerlink" href="#property-evaluation" title="Permalink to this headline">¶</a></h2>
<p>Properties are resolved within LFH using a multi-pass approach which supports property overriding.</p>
<ol class="arabic simple">
<li><p>First, properties are loaded from the class path from the <strong>application.properties</strong> file within the LFH application jar.</p></li>
<li><p>Next, properties are loaded from an external file <strong>[application working directory]/config/application.properties</strong>.</p></li>
<li><p>Finally, properties are loaded from environment variables.</p></li>
</ol>
<p>LFH environment variable names are use upper-case characters with “_” (underscore) separators. LFH environment variables are translated to property settings by translating characters to lower-case and replacing “_” separators with a “.”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># environment variable</span>
<span class="n">LFH_CONNECT_FHIR</span><span class="o">-</span><span class="n">R4_URI</span><span class="o">=</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">fhir</span><span class="o">/</span><span class="n">r4</span>

<span class="c1"># translated property</span>
<span class="n">lfh</span><span class="o">.</span><span class="n">connect</span><span class="o">.</span><span class="n">fhir</span><span class="o">-</span><span class="n">r4</span><span class="o">.</span><span class="n">uri</span><span class="o">=</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">fhir</span><span class="o">/</span><span class="n">r4</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="message-structure.html" class="btn btn-neutral float-right" title="Message Structure" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tutorials/firstroute.html" class="btn btn-neutral float-left" title="Hello World" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, IBM

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>