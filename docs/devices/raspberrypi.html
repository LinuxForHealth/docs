

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Raspberry Pi &mdash; Linux for Health  documentation</title>
  

  
  
  
  
    <link rel="canonical" href="https://linuxforhealth.github.io/docs/devices/raspberrypi.html"/>
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Kubernetes Support" href="../deployment/kubernetes.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: 0x4380B4" >
          

          
            <a href="../index.html" class="icon icon-home"> Linux for Health
          

          
          </a>

          
            
            
              <div class="version">
                master
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer-setup.html">Developer Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/quickstart.html">QuickStart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../application-configuration.html">Application Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../message-structure.html">Message Structure</a></li>
</ul>
<p class="caption"><span class="caption-text">Routes:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../routes/fhir-r4.html">FHIR R4</a></li>
</ul>
<p class="caption"><span class="caption-text">Develop:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../develop/develop.html">LinuxForHealth Connect Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop/secured-communications.html">Secured Communications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop/data-synchronization.html">Data Synchronization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop/testing.html">Testing</a></li>
</ul>
<p class="caption"><span class="caption-text">Deployment:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../deployment/compose.html">Docker Compose Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment/container.html">Container Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment/kubernetes.html">Kubernetes Support</a></li>
</ul>
<p class="caption"><span class="caption-text">Devices:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Raspberry Pi</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#image-and-run-your-raspberry-pi">Image and Run Your Raspberry Pi</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configure-the-python-environment">Configure the Python Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#install-docker-and-docker-compose">Install Docker and docker-compose</a></li>
<li class="toctree-l2"><a class="reference internal" href="#build-and-install-librdkafka">Build and Install librdkafka</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configure-and-run-linuxforhealth-connect">Configure and Run LinuxForHealth connect</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Linux for Health</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Raspberry Pi</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/devices/raspberrypi.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="raspberry-pi">
<h1>Raspberry Pi<a class="headerlink" href="#raspberry-pi" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>LinuxForHealth is deployable to amd64, s390x and arm64 (aarch64) devices and may be built to support other chip architectures. These instructions explain how to bring up an arm64 Raspberry Pi device from scratch and were tested with a Raspberry Pi 3B+.  All steps are executed on the Raspberry Pi, with the exception of the first three steps to image the Raspberry Pi micro SD card.</p>
</div>
<div class="section" id="image-and-run-your-raspberry-pi">
<h2>Image and Run Your Raspberry Pi<a class="headerlink" href="#image-and-run-your-raspberry-pi" title="Permalink to this headline">¶</a></h2>
<p>These instructions explain how to image and run a new Raspberry Pi (or one you want to re-image). If you have a running Raspberry Pi with an up-to-date 64-bit Pi OS, skip to the next section.</p>
<ol class="arabic simple">
<li><p>Download the (Raspberry Pi imager)[<a class="reference external" href="https://www.raspberrypi.org/downloads/">https://www.raspberrypi.org/downloads/</a>] for your computer’s OS. This will allow you to image a micro SD card with the Raspberry Pi OS image, since the OS image is too big to copy.</p></li>
<li><p>Download the (64-bit Raspberry Pi OS -arm64.zip file)[<a class="reference external" href="https://downloads.raspberrypi.org/raspios_arm64/images">https://downloads.raspberrypi.org/raspios_arm64/images</a>]. Example: 2021-05-07-raspios-buster-arm64.zip</p></li>
<li><p>Image your micro SD card</p>
<ul class="simple">
<li><p>Plug your micro SD reader into your computer.</p></li>
<li><p>Run the Raspberry Pi imager.</p></li>
<li><p>Click “Choose OS”, select “Use custom”, then select the arm64 .zip file you just downloaded.</p></li>
<li><p>Click “Choose SD card” then select your micro SD card and click “Write”.</p></li>
</ul>
</li>
<li><p>Bring up your Raspberry Pi</p>
<ul class="simple">
<li><p>Connect all your peripherals to your Raspberry Pi - usb keyboard, mouse, hdmi display.</p></li>
<li><p>Insert your micro SD card in your Raspberry Pi and power up the Pi.</p></li>
</ul>
</li>
<li><p>Walk through the setup in the Raspberry Pi desktop when prompted, including network configuration.  Be sure to enable the ssh interface under Preferences-&gt;Raspberry Pi Configuration-&gt;Interfaces, then restart your Raspberry Pi.</p></li>
<li><p>On your Raspberry Pi desktop, open a command window and run ifconfig to find the Pi’s IP address.  Make a note of this IP so you can ssh into the Pi.  The remaining steps can be done via ssh, if desired.</p></li>
</ol>
</div>
<div class="section" id="configure-the-python-environment">
<h2>Configure the Python Environment<a class="headerlink" href="#configure-the-python-environment" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p>Upgrade Python on your Raspberry Pi to 3.8.  Python 3.8 is not currently available on Pi OS, so a workaround is provided via an additional repository.</p>
<p>Get the GPG key:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">pascalroeleven</span><span class="o">.</span><span class="n">nl</span><span class="o">/</span><span class="n">deb</span><span class="o">-</span><span class="n">pascalroeleven</span><span class="o">.</span><span class="n">gpg</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">key</span> <span class="n">add</span> <span class="n">deb</span><span class="o">-</span><span class="n">pascalroeleven</span><span class="o">.</span><span class="n">gpg</span>
</pre></div>
</div>
<p>Edit /etc/apt/sources.list and add this repository:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">deb</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">deb</span><span class="o">.</span><span class="n">pascalroeleven</span><span class="o">.</span><span class="n">nl</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">8</span> <span class="n">buster</span><span class="o">-</span><span class="n">backports</span> <span class="n">main</span>
</pre></div>
</div>
<p>Install python 3.8 and related packages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">update</span>
<span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">python3</span><span class="o">.</span><span class="mi">8</span> <span class="n">python3</span><span class="o">.</span><span class="mi">8</span><span class="o">-</span><span class="n">venv</span> <span class="n">python3</span><span class="o">.</span><span class="mi">8</span><span class="o">-</span><span class="n">dev</span>
</pre></div>
</div>
</li>
<li><p>Upgrade pip:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="n">pip</span>
</pre></div>
</div>
</li>
<li><p>Add aliases to your .bashrc file to ensure the correct python and pip versions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alias</span> <span class="n">python</span><span class="o">=</span><span class="n">python3</span><span class="o">.</span><span class="mi">8</span>
<span class="n">alias</span> <span class="n">python3</span><span class="o">=</span><span class="n">python3</span><span class="o">.</span><span class="mi">8</span>
<span class="n">alias</span> <span class="n">pip</span><span class="o">=</span><span class="n">pip3</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="install-docker-and-docker-compose">
<h2>Install Docker and docker-compose<a class="headerlink" href="#install-docker-and-docker-compose" title="Permalink to this headline">¶</a></h2>
<p>Install docker and docker-compose on your Raspberry Pi, following these instructions:</p>
<p>Upgrade the pi:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span> <span class="o">&amp;&amp;</span> <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">upgrade</span>
</pre></div>
</div>
<p>Install docker:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">sSL</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">get</span><span class="o">.</span><span class="n">docker</span><span class="o">.</span><span class="n">com</span> <span class="o">|</span> <span class="n">sh</span>
</pre></div>
</div>
<p>Add the current user to the docker group, which allows you to run docker without sudo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>sudo usermod -aG docker ${USER}
</pre></div>
</div>
<p>Install docker-compose:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">libffi</span><span class="o">-</span><span class="n">dev</span> <span class="n">libssl</span><span class="o">-</span><span class="n">dev</span>
<span class="n">sudo</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">docker</span><span class="o">-</span><span class="n">compose</span>
</pre></div>
</div>
</div>
<div class="section" id="build-and-install-librdkafka">
<h2>Build and Install librdkafka<a class="headerlink" href="#build-and-install-librdkafka" title="Permalink to this headline">¶</a></h2>
<p>Remove the downlevel version of librdkafka that is distributed with Pi OS:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">remove</span> <span class="n">librdkafka</span><span class="o">-</span><span class="n">dev</span>
</pre></div>
</div>
<p>Clone and build librdkafka:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">edenhill</span><span class="o">/</span><span class="n">librdkafka</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">librdkafka</span>
<span class="o">./</span><span class="n">configure</span>
<span class="n">make</span>
<span class="n">sudo</span> <span class="n">make</span> <span class="n">install</span>
</pre></div>
</div>
<p>Replace the aarch64 version of librdkafka (not covered by the librdkafka <cite>sudo make install</cite> step):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">cp</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">librdkafka</span><span class="o">.</span><span class="n">so</span><span class="o">.</span><span class="mi">1</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">aarch64</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span>
<span class="n">sudo</span> <span class="n">cp</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">librdkafka</span><span class="o">++.</span><span class="n">so</span><span class="o">.</span><span class="mi">1</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">aarch64</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span>
</pre></div>
</div>
</div>
<div class="section" id="configure-and-run-linuxforhealth-connect">
<h2>Configure and Run LinuxForHealth connect<a class="headerlink" href="#configure-and-run-linuxforhealth-connect" title="Permalink to this headline">¶</a></h2>
<p>Install pipenv:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">pipenv</span>
</pre></div>
</div>
<p>Clone LinuxForHealth:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">LinuxForHealth</span><span class="o">/</span><span class="n">connect</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>Create a connect virtual environment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">connect</span>
<span class="n">pipenv</span> <span class="o">--</span><span class="n">python</span> <span class="mf">3.8</span> <span class="n">sync</span> <span class="o">--</span><span class="n">dev</span>
</pre></div>
</div>
<p>Add <strong>KAFKA_HEAP_OPTS: “-Xmx256M”</strong> memory restriction to kafka environment variables in connect/docker-compose.yml.  Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kafka</span><span class="p">:</span>
  <span class="n">networks</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">main</span>
  <span class="n">image</span><span class="p">:</span> <span class="n">docker</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">linuxforhealth</span><span class="o">/</span><span class="n">kafka</span><span class="o">-</span><span class="n">alpine</span><span class="p">:</span><span class="mf">2.5</span><span class="o">.</span><span class="mi">0</span>
  <span class="n">restart</span><span class="p">:</span> <span class="s2">&quot;always&quot;</span>
  <span class="n">ports</span><span class="p">:</span>
    <span class="o">-</span> <span class="s2">&quot;9094:9094&quot;</span>
  <span class="n">environment</span><span class="p">:</span>
    <span class="n">KAFKA_ZOOKEEPER_CONNECT</span><span class="p">:</span> <span class="n">zookeeper</span><span class="p">:</span><span class="mi">2181</span>
    <span class="n">KAFKA_LISTENERS</span><span class="p">:</span> <span class="n">INTERNAL</span><span class="p">:</span><span class="o">//</span><span class="n">kafka</span><span class="p">:</span><span class="mi">9092</span><span class="p">,</span><span class="n">EXTERNAL</span><span class="p">:</span><span class="o">//</span><span class="n">kafka</span><span class="p">:</span><span class="mi">9094</span>
    <span class="n">KAFKA_ADVERTISED_LISTENERS</span><span class="p">:</span> <span class="n">INTERNAL</span><span class="p">:</span><span class="o">//</span><span class="n">kafka</span><span class="p">:</span><span class="mi">9092</span><span class="p">,</span><span class="n">EXTERNAL</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">9094</span>
    <span class="n">KAFKA_LISTENER_SECURITY_PROTOCOL_MAP</span><span class="p">:</span> <span class="n">INTERNAL</span><span class="p">:</span><span class="n">PLAINTEXT</span><span class="p">,</span><span class="n">EXTERNAL</span><span class="p">:</span><span class="n">PLAINTEXT</span>
    <span class="n">KAFKA_INTER_BROKER_LISTENER_NAME</span><span class="p">:</span> <span class="n">INTERNAL</span>
    <span class="n">KAFKA_HEAP_OPTS</span><span class="p">:</span> <span class="s2">&quot;-Xmx256M&quot;</span>
</pre></div>
</div>
<p>Bring up connect services:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="n">up</span> <span class="o">-</span><span class="n">d</span>
</pre></div>
</div>
<p>Start connect:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pipenv</span> <span class="n">run</span> <span class="n">connect</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../deployment/kubernetes.html" class="btn btn-neutral float-left" title="Kubernetes Support" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
 
<div class="footer">
    <p>
        LinuxForHealth is sublicensed by the Linux Foundation with Sublicense ID: 20200615-0008
    </p>
</div>    


</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>